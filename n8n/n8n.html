<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>n8n - Workflow Automation</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ============================================
           n8n Exact Color Palette
           ============================================ */
        :root {
            --bg-body: #1a1a1a;
            --bg-canvas: #2b2b2b;
            --bg-topbar: #1a1a1a;
            --bg-surface: #3d3d3d;
            --bg-surface-hover: #4a4a4a;
            --bg-input: #2b2b2b;
            --bg-panel: #252526;
            --bg-ndv: #1e1e1e;

            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --text-muted: #808080;
            --text-placeholder: #666666;

            --border-color: #3d3d3d;
            --border-light: #5a5a5a;
            --border-dashed: #6b6b6b;

            --accent-coral: #ff6d5a;
            --accent-coral-hover: #ff8473;
            --accent-green: #27ae60;
            --accent-blue: #3498db;

            --btn-dark-bg: #3d3d3d;
            --btn-dark-hover: #4a4a4a;

            --grid-dot-color: rgba(255, 255, 255, 0.08);
            --grid-size: 20px;

            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
            overflow: hidden;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 13px;
            background: var(--bg-body);
            color: var(--text-primary);
            line-height: 1.4;
        }

        .n8n-app {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* ============================================
           Top Bar
           ============================================ */
        .topbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 50px;
            padding: 0 12px;
            background: var(--bg-topbar);
            border-bottom: 1px solid var(--border-color);
            z-index: 100;
        }

        .topbar-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .topbar-left {
            flex: 1;
        }

        .topbar-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .topbar-right {
            flex: 1;
            justify-content: flex-end;
        }

        .workflow-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            background: transparent;
            border: none;
            outline: none;
            padding: 6px 8px;
            border-radius: 4px;
            min-width: 120px;
        }

        .workflow-name:hover,
        .workflow-name:focus {
            background: var(--bg-surface);
        }

        .add-tag-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            font-size: 12px;
            color: var(--text-muted);
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .add-tag-btn:hover {
            color: var(--text-secondary);
            background: var(--bg-surface);
        }

        .editor-tabs {
            display: flex;
            background: var(--bg-surface);
            border-radius: 6px;
            padding: 3px;
        }

        .editor-tab {
            padding: 6px 16px;
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .editor-tab:hover {
            color: var(--text-primary);
        }

        .editor-tab.active {
            color: var(--text-primary);
            background: var(--bg-canvas);
        }

        .toggle-wrapper {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toggle-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .toggle-switch {
            position: relative;
            width: 40px;
            height: 22px;
            background: var(--bg-surface);
            border-radius: 11px;
            cursor: pointer;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            background: var(--text-secondary);
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.2s;
        }

        .toggle-switch.active {
            background: var(--accent-green);
        }

        .toggle-switch.active::after {
            left: 20px;
            background: white;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 8px 16px;
            font-family: inherit;
            font-size: 13px;
            font-weight: 500;
            border-radius: 6px;
            cursor: pointer;
            border: none;
        }

        .btn-dark {
            background: var(--btn-dark-bg);
            color: var(--text-primary);
        }

        .btn-dark:hover {
            background: var(--btn-dark-hover);
        }

        .btn-coral {
            background: var(--accent-coral);
            color: white;
        }

        .btn-coral:hover {
            background: var(--accent-coral-hover);
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            padding: 0;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 6px;
        }

        .btn-icon:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
        }

        .github-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            background: var(--bg-surface);
            border-radius: 6px;
            font-size: 12px;
            color: var(--text-primary);
            text-decoration: none;
            border: 1px solid var(--border-color);
        }

        .github-badge:hover {
            background: var(--bg-surface-hover);
        }

        .github-badge svg {
            width: 16px;
            height: 16px;
        }

        /* ============================================
           Canvas
           ============================================ */
        .canvas-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: var(--bg-canvas);
        }

        .canvas-wrapper::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: radial-gradient(circle at center, var(--grid-dot-color) 1.5px, transparent 1.5px);
            background-size: var(--grid-size) var(--grid-size);
            pointer-events: none;
        }

        .canvas-viewport {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-origin: 0 0;
        }

        .connections-layer {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: visible;
        }

        .nodes-container {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .nodes-container>* {
            pointer-events: auto;
        }

        .add-first-step {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            z-index: 10;
        }

        .add-first-step-box {
            width: 100px;
            height: 100px;
            border: 2px dashed var(--border-dashed);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-first-step:hover .add-first-step-box {
            border-color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.02);
        }

        .add-first-step-icon {
            font-size: 32px;
            color: var(--text-secondary);
        }

        .add-first-step-text {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .canvas-controls {
            position: absolute;
            bottom: 16px;
            left: 16px;
            display: flex;
            gap: 4px;
            z-index: 50;
        }

        .control-btn {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-topbar);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .control-btn:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
        }

        .control-btn svg {
            width: 18px;
            height: 18px;
        }

        .add-node-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-topbar);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 20px;
            z-index: 50;
        }

        .add-node-btn:hover {
            background: var(--bg-surface);
        }

        /* Canvas Nodes */
        .canvas-node {
            position: absolute;
            min-width: 150px;
            max-width: 200px;
            background: var(--bg-panel);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            user-select: none;
        }

        .canvas-node:hover {
            border-color: var(--border-light);
        }

        .canvas-node.selected {
            border-color: var(--accent-coral);
            box-shadow: 0 0 0 2px rgba(255, 109, 90, 0.2);
        }

        .canvas-node-content {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
        }

        .canvas-node-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-surface);
            border-radius: 8px;
            color: var(--text-secondary);
        }

        .canvas-node-icon svg {
            width: 18px;
            height: 18px;
        }

        .canvas-node-icon.trigger {
            background: rgba(39, 174, 96, 0.15);
            color: var(--accent-green);
        }

        .canvas-node-title {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .node-handle {
            position: absolute;
            width: 14px;
            height: 14px;
            background: var(--border-light);
            border: 2px solid var(--bg-canvas);
            border-radius: 50%;
            cursor: crosshair;
            z-index: 10;
        }

        .node-handle:hover {
            transform: scale(1.3);
            background: var(--accent-coral);
        }

        .node-handle.input {
            left: -7px;
            top: 50%;
            margin-top: -7px;
        }

        .node-handle.output {
            right: -7px;
            top: 50%;
            margin-top: -7px;
        }

        /* ============================================
           Node Panel (Trigger Selection)
           ============================================ */
        .node-panel {
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 100%;
            background: var(--bg-panel);
            border-left: 1px solid var(--border-color);
            transform: translateX(100%);
            transition: transform 0.25s ease;
            z-index: 200;
            display: flex;
            flex-direction: column;
        }

        .node-panel.open {
            transform: translateX(0);
        }

        .node-panel-trigger-header {
            padding: 20px 20px 16px 20px;
        }

        .node-panel-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0 0 6px 0;
        }

        .node-panel-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin: 0;
        }

        .node-panel-search-wrapper {
            padding: 0 16px 16px 16px;
        }

        .node-panel-search {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 6px;
        }

        .node-panel-search:focus-within {
            border-color: var(--text-muted);
        }

        .node-panel-search input {
            flex: 1;
            background: transparent;
            border: none;
            outline: none;
            font-size: 13px;
            color: var(--text-primary);
        }

        .node-panel-search input::placeholder {
            color: var(--text-placeholder);
        }

        .node-panel-search svg {
            width: 16px;
            height: 16px;
            color: var(--text-muted);
        }

        .node-panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 8px 20px 8px;
        }

        .trigger-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
        }

        .trigger-item:hover {
            background: var(--bg-surface);
        }

        .trigger-item-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .trigger-item-icon svg {
            width: 20px;
            height: 20px;
        }

        .trigger-item-content {
            flex: 1;
        }

        .trigger-item-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .trigger-item-desc {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.4;
        }

        .trigger-item-arrow {
            color: var(--text-muted);
            margin-top: 4px;
        }

        .trigger-item-arrow svg {
            width: 16px;
            height: 16px;
        }

        /* ============================================
           NDV - Node Detail View (Full Screen)
           ============================================ */
        .ndv-overlay {
            position: fixed;
            inset: 0;
            background: var(--bg-ndv);
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .ndv-overlay.open {
            display: flex;
        }

        .ndv-topbar {
            display: flex;
            align-items: center;
            height: 50px;
            padding: 0 16px;
            background: var(--bg-topbar);
            border-bottom: 1px solid var(--border-color);
        }

        .ndv-back {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            background: none;
            border: none;
            border-radius: 4px;
        }

        .ndv-back:hover {
            color: var(--text-primary);
            background: var(--bg-surface);
        }

        .ndv-back svg {
            width: 16px;
            height: 16px;
        }

        .ndv-main {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        /* Input Panel */
        .ndv-input-panel {
            width: 350px;
            background: var(--bg-panel);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .ndv-panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .ndv-panel-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            letter-spacing: 0.5px;
        }

        .ndv-panel-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-toggle {
            display: flex;
            background: var(--bg-surface);
            border-radius: 4px;
            padding: 2px;
        }

        .view-toggle-btn {
            padding: 4px 10px;
            font-size: 11px;
            color: var(--text-secondary);
            background: transparent;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }

        .view-toggle-btn:hover {
            color: var(--text-primary);
        }

        .view-toggle-btn.active {
            color: var(--text-primary);
            background: var(--bg-panel);
        }

        .ndv-panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        /* Center Panel */
        .ndv-center-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-panel);
            border-right: 1px solid var(--border-color);
        }

        .ndv-node-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .ndv-node-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-surface);
            border-radius: 8px;
            color: var(--text-secondary);
        }

        .ndv-node-icon svg {
            width: 18px;
            height: 18px;
        }

        .ndv-node-icon.trigger {
            background: rgba(39, 174, 96, 0.15);
            color: var(--accent-green);
        }

        .ndv-node-name {
            flex: 1;
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            background: none;
            border: none;
            outline: none;
        }

        .btn-execute {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            background: var(--accent-coral);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
        }

        .btn-execute:hover {
            background: var(--accent-coral-hover);
        }

        .btn-execute svg {
            width: 14px;
            height: 14px;
        }

        .ndv-tabs {
            display: flex;
            align-items: center;
            gap: 24px;
            padding: 0 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .ndv-tab {
            padding: 12px 0;
            font-size: 13px;
            color: var(--text-secondary);
            background: none;
            border: none;
            cursor: pointer;
            position: relative;
        }

        .ndv-tab:hover {
            color: var(--text-primary);
        }

        .ndv-tab.active {
            color: var(--accent-coral);
        }

        .ndv-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--accent-coral);
        }

        .ndv-docs-link {
            margin-left: auto;
            font-size: 12px;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .ndv-docs-link:hover {
            color: var(--text-secondary);
        }

        .ndv-docs-link svg {
            width: 12px;
            height: 12px;
        }

        .ndv-form-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 6px;
        }

        .form-input {
            width: 100%;
            padding: 10px 12px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            font-family: 'Monaco', 'Menlo', monospace;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-coral);
        }

        .form-input::placeholder {
            color: var(--text-placeholder);
        }

        .form-hint {
            margin-top: 6px;
            font-size: 11px;
            color: var(--text-muted);
        }

        .form-select {
            width: 100%;
            padding: 10px 12px;
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 13px;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23808080' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
        }

        .form-section {
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .form-section-title {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .form-section-empty {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }

        .btn-add-field {
            width: 100%;
            padding: 10px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn-add-field:hover {
            border-color: var(--border-light);
            color: var(--text-primary);
        }

        /* Output Panel */
        .ndv-output-panel {
            width: 400px;
            background: var(--bg-panel);
            display: flex;
            flex-direction: column;
        }

        .ndv-output-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .ndv-output-indicators {
            display: flex;
            gap: 4px;
        }

        .ndv-output-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--border-color);
        }

        .ndv-output-content {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .json-viewer {
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 12px;
            line-height: 1.6;
            color: var(--text-secondary);
        }

        .json-key {
            color: var(--text-secondary);
        }

        .json-string {
            color: var(--accent-coral);
        }

        .json-number {
            color: var(--accent-blue);
        }

        .json-bracket {
            color: var(--text-muted);
        }

        .ndv-output-footer {
            padding: 12px 16px;
            border-top: 1px solid var(--border-color);
        }

        .ndv-feedback {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .ndv-feedback svg {
            width: 14px;
            height: 14px;
        }

        .toast-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
        }

        .toast {
            padding: 12px 20px;
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 13px;
            box-shadow: var(--shadow-md);
        }

        .hidden {
            display: none !important;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <div class="n8n-app">
        <!-- Top Bar -->
        <header class="topbar">
            <div class="topbar-section topbar-left">
                <input type="text" class="workflow-name" value="My workflow 13">
                <button class="add-tag-btn"><span>+</span><span>Add tag</span></button>
            </div>
            <div class="topbar-section topbar-center">
                <div class="editor-tabs">
                    <button class="editor-tab active">Editor</button>
                    <button class="editor-tab">Executions</button>
                </div>
            </div>
            <div class="topbar-section topbar-right">
                <div class="toggle-wrapper">
                    <span class="toggle-label">Inactive</span>
                    <div class="toggle-switch"></div>
                </div>
                <button class="btn btn-dark">Share</button>
                <button class="btn btn-coral">Save</button>
                <button class="btn btn-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12 6 12 12 16 14" />
                    </svg>
                </button>
                <button class="btn btn-icon">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                        <circle cx="12" cy="5" r="1.5" />
                        <circle cx="12" cy="12" r="1.5" />
                        <circle cx="12" cy="19" r="1.5" />
                    </svg>
                </button>
                <a href="#" class="github-badge">
                    <svg viewBox="0 0 16 16" fill="currentColor">
                        <path
                            d="M8 .25a.75.75 0 0 1 .673.418l1.882 3.815 4.21.612a.75.75 0 0 1 .416 1.279l-3.046 2.97.719 4.192a.75.75 0 0 1-1.088.791L8 12.347l-3.766 1.98a.75.75 0 0 1-1.088-.79l.72-4.194L.818 6.374a.75.75 0 0 1 .416-1.28l4.21-.611L7.327.668A.75.75 0 0 1 8 .25z" />
                    </svg>
                    <span>Star</span><span>162,988</span>
                </a>
            </div>
        </header>

        <!-- Canvas -->
        <div class="canvas-wrapper" id="canvas-wrapper">
            <div class="canvas-viewport" id="canvas-viewport">
                <svg class="connections-layer">
                    <g id="connections-group"></g>
                </svg>
                <div class="nodes-container" id="nodes-container"></div>
            </div>

            <div class="add-first-step" id="add-first-step">
                <div class="add-first-step-box"><span class="add-first-step-icon">+</span></div>
                <span class="add-first-step-text">Add first step...</span>
            </div>

            <div class="canvas-controls">
                <button class="control-btn" id="btn-fit"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7" />
                    </svg></button>
                <button class="control-btn" id="btn-zoom-in"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="11" cy="11" r="8" />
                        <path d="M21 21l-4.35-4.35M11 8v6M8 11h6" />
                    </svg></button>
                <button class="control-btn" id="btn-zoom-out"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="11" cy="11" r="8" />
                        <path d="M21 21l-4.35-4.35M8 11h6" />
                    </svg></button>
                <button class="control-btn"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
                    </svg></button>
            </div>

            <button class="add-node-btn" id="add-node-btn">+</button>

            <!-- Trigger Panel -->
            <aside class="node-panel" id="node-panel">
                <div class="node-panel-trigger-header">
                    <h2 class="node-panel-title">What triggers this workflow?</h2>
                    <p class="node-panel-subtitle">A trigger is a step that starts your workflow</p>
                </div>
                <div class="node-panel-search-wrapper">
                    <div class="node-panel-search">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8" />
                            <path d="M21 21l-4.35-4.35" />
                        </svg>
                        <input type="text" id="node-search" placeholder="Search nodes...">
                    </div>
                </div>
                <div class="node-panel-content" id="node-panel-content"></div>
            </aside>
        </div>
    </div>

    <!-- NDV Overlay -->
    <div class="ndv-overlay" id="ndv-overlay">
        <div class="ndv-topbar">
            <button class="ndv-back" id="ndv-back">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
                Back to canvas
            </button>
        </div>
        <div class="ndv-main">
            <!-- Input Panel -->
            <div class="ndv-input-panel">
                <div class="ndv-panel-header">
                    <span class="ndv-panel-label">INPUT</span>
                    <div class="ndv-panel-actions">
                        <div class="view-toggle">
                            <button class="view-toggle-btn active">Schema</button>
                            <button class="view-toggle-btn">Table</button>
                            <button class="view-toggle-btn">JSON</button>
                        </div>
                    </div>
                </div>
                <div class="ndv-panel-content" id="ndv-input-content">
                    <div style="color: var(--text-muted); text-align: center; padding: 40px 20px;">
                        <p>No input data</p>
                        <p style="font-size: 11px; margin-top: 8px;">Connect a node to see input</p>
                    </div>
                </div>
            </div>

            <!-- Center Panel -->
            <div class="ndv-center-panel">
                <div class="ndv-node-header">
                    <div class="ndv-node-icon trigger" id="ndv-node-icon"></div>
                    <input type="text" class="ndv-node-name" id="ndv-node-name" value="">
                    <button class="btn-execute" id="btn-execute">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3" />
                        </svg>
                        Execute step
                    </button>
                </div>
                <div class="ndv-tabs">
                    <button class="ndv-tab active">Parameters</button>
                    <button class="ndv-tab">Settings</button>
                    <a href="#" class="ndv-docs-link">Docs <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                            <polyline points="15 3 21 3 21 9" />
                            <line x1="10" y1="14" x2="21" y2="3" />
                        </svg></a>
                </div>
                <div class="ndv-form-content" id="ndv-form-content"></div>
            </div>

            <!-- Output Panel -->
            <div class="ndv-output-panel">
                <div class="ndv-output-header">
                    <span class="ndv-panel-label">OUTPUT</span>
                    <div class="ndv-output-indicators">
                        <div class="ndv-output-indicator"></div>
                        <div class="ndv-output-indicator"></div>
                    </div>
                    <div class="ndv-panel-actions">
                        <div class="view-toggle">
                            <button class="view-toggle-btn">Schema</button>
                            <button class="view-toggle-btn">Table</button>
                            <button class="view-toggle-btn active">JSON</button>
                        </div>
                    </div>
                </div>
                <div class="ndv-output-content" id="ndv-output-content">
                    <div style="color: var(--text-muted); text-align: center; padding: 40px 20px;">
                        <p>No output data</p>
                        <p style="font-size: 11px; margin-top: 8px;">Execute the node to see output</p>
                    </div>
                </div>
                <div class="ndv-output-footer">
                    <div class="ndv-feedback">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                            <line x1="12" y1="17" x2="12.01" y2="17" />
                        </svg>
                        I wish this node would...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toast-container"></div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        const TRIGGERS = [
            { id: 'manual-trigger', name: 'Trigger manually', desc: 'Runs the flow on clicking a button in n8n. Good for getting started quickly', icon: 'cursor' },
            { id: 'app-event', name: 'On app event', desc: 'Runs the flow when something happens in an app like Telegram, Notion or Airtable', icon: 'bell', arrow: true },
            { id: 'schedule', name: 'On a schedule', desc: 'Runs the flow every day, hour, or custom interval', icon: 'clock' },
            { id: 'webhook', name: 'On webhook call', desc: 'Runs the flow on receiving an HTTP request', icon: 'webhook' },
            { id: 'form', name: 'On form submission', desc: 'Generate webforms in n8n and pass their responses to the workflow', icon: 'form' },
            { id: 'execute-workflow', name: 'When Executed by Another Workflow', desc: 'Runs the flow when called by the Execute Workflow node from a different workflow', icon: 'play' },
            { id: 'chat', name: 'On chat message', desc: 'Runs the flow when a user sends a chat message. For use with AI nodes', icon: 'chat' },
            { id: 'other', name: 'Other ways...', desc: 'Runs the flow on workflow errors, file changes, etc.', icon: 'folder', arrow: true }
        ];

        const ICONS = {
            cursor: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 3l14 9-6 2-4 6-4-17z"/></svg>`,
            bell: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>`,
            clock: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>`,
            webhook: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 3v6m0 6v6M3 12h6m6 0h6"/></svg>`,
            form: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M7 7h10M7 12h10M7 17h6"/></svg>`,
            play: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"/></svg>`,
            chat: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>`,
            folder: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg>`,
            arrow: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>`
        };

        const state = { nodes: [], selectedId: null, currentNdvId: null, zoom: 1, panX: 0, panY: 0, nextId: 1 };

        $(document).ready(() => {
            renderTriggers();
            bindEvents();
        });

        function renderTriggers() {
            const $c = $('#node-panel-content').empty();
            TRIGGERS.forEach(t => {
                $c.append(`
                    <div class="trigger-item" data-id="${t.id}" data-name="${t.name}" data-icon="${t.icon}">
                        <div class="trigger-item-icon">${ICONS[t.icon]}</div>
                        <div class="trigger-item-content">
                            <div class="trigger-item-name">${t.name}</div>
                            <div class="trigger-item-desc">${t.desc}</div>
                        </div>
                        ${t.arrow ? `<div class="trigger-item-arrow">${ICONS.arrow}</div>` : ''}
                    </div>
                `);
            });
        }

        function bindEvents() {
            $('#add-first-step, #add-node-btn').on('click', () => $('#node-panel').addClass('open'));

            $('#canvas-wrapper').on('click', e => {
                if (!$(e.target).closest('.node-panel, .canvas-node, .add-node-btn, .add-first-step, .control-btn').length) {
                    $('#node-panel').removeClass('open');
                }
            });

            $(document).on('click', '.trigger-item', function () {
                const id = $(this).data('id'), name = $(this).data('name'), icon = $(this).data('icon');
                const $c = $('#canvas-wrapper');
                const x = ($c.width() / 2 - state.panX) / state.zoom - 75;
                const y = ($c.height() / 2 - state.panY) / state.zoom - 30;
                createNode({ type: id, name, icon }, x, y);
                $('#node-panel').removeClass('open');
            });

            $('#node-search').on('input', function () {
                const q = $(this).val().toLowerCase();
                $('.trigger-item').each(function () {
                    const m = $(this).find('.trigger-item-name').text().toLowerCase().includes(q) ||
                        $(this).find('.trigger-item-desc').text().toLowerCase().includes(q);
                    $(this).toggle(m);
                });
            });

            $(document).on('click', '.canvas-node', function (e) {
                e.stopPropagation();
                const id = +$(this).data('node-id');
                selectNode(id);
                openNdv(id);
            });

            $('#ndv-back').on('click', closeNdv);
            $('#btn-execute').on('click', executeNode);

            $(document).on('click', '.view-toggle-btn', function () {
                $(this).siblings().removeClass('active');
                $(this).addClass('active');
            });

            $(document).on('click', '.ndv-tab', function () {
                $(this).siblings('.ndv-tab').removeClass('active');
                $(this).addClass('active');
            });

            $(document).on('keydown', e => {
                if (e.key === 'Escape') {
                    if ($('#ndv-overlay').hasClass('open')) closeNdv();
                    else $('#node-panel').removeClass('open');
                }
                if ((e.key === 'Delete' || e.key === 'Backspace') && state.selectedId && !$(e.target).is('input')) {
                    deleteNode(state.selectedId);
                }
            });

            $('#btn-zoom-in').on('click', () => { state.zoom = Math.min(2, state.zoom + 0.1); updateTransform(); });
            $('#btn-zoom-out').on('click', () => { state.zoom = Math.max(0.25, state.zoom - 0.1); updateTransform(); });
            $('#btn-fit').on('click', () => { state.zoom = 1; state.panX = 0; state.panY = 0; updateTransform(); });
            $('#canvas-wrapper').on('wheel', e => { e.preventDefault(); state.zoom = Math.max(0.25, Math.min(2, state.zoom + (e.originalEvent.deltaY > 0 ? -0.1 : 0.1))); updateTransform(); });
        }

        function createNode(data, x, y) {
            const node = { id: state.nextId++, type: data.type, name: data.name, icon: data.icon, x, y, params: {} };
            state.nodes.push(node);
            $('#nodes-container').append(`
                <div class="canvas-node" data-node-id="${node.id}" style="left:${x}px;top:${y}px">
                    <div class="canvas-node-content">
                        <div class="canvas-node-icon trigger">${ICONS[node.icon]}</div>
                        <div class="canvas-node-title">${node.name}</div>
                    </div>
                    <div class="node-handle output"></div>
                </div>
            `);
            $('#add-first-step').addClass('hidden');
            selectNode(node.id);
            toast(`Added "${node.name}"`);
        }

        function selectNode(id) {
            state.selectedId = id;
            $('.canvas-node').removeClass('selected');
            $(`.canvas-node[data-node-id="${id}"]`).addClass('selected');
        }

        function deleteNode(id) {
            state.nodes = state.nodes.filter(n => n.id !== id);
            $(`.canvas-node[data-node-id="${id}"]`).remove();
            state.selectedId = null;
            if (!state.nodes.length) $('#add-first-step').removeClass('hidden');
            toast('Node deleted');
        }

        function openNdv(id) {
            const node = state.nodes.find(n => n.id === id);
            if (!node) return;
            state.currentNdvId = id;
            $('#ndv-node-icon').html(ICONS[node.icon]);
            $('#ndv-node-name').val(node.name);
            renderNdvForm(node);
            $('#ndv-overlay').addClass('open');
        }

        function closeNdv() {
            $('#ndv-overlay').removeClass('open');
            state.currentNdvId = null;
        }

        function renderNdvForm(node) {
            $('#ndv-form-content').html(`
                <div class="form-group">
                    <p style="color: var(--text-muted);">This node will trigger the workflow when executed.</p>
                </div>
                <div class="form-section">
                    <div class="form-section-title">Options</div>
                    <div class="form-section-empty">No properties</div>
                    <button class="btn-add-field">Add Field <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></button>
                </div>
            `);
        }

        function executeNode() {
            const node = state.nodes.find(n => n.id === state.currentNdvId);
            if (!node) return;
            toast(`Executed "${node.name}"`);
            $('#ndv-output-content').html(`
                <div class="json-viewer">
                    <span class="json-bracket">[</span><br>
                    &nbsp;&nbsp;<span class="json-bracket">{</span><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="json-key">"success"</span>: <span class="json-number">true</span>,<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="json-key">"timestamp"</span>: <span class="json-string">"${new Date().toISOString()}"</span><br>
                    &nbsp;&nbsp;<span class="json-bracket">}</span><br>
                    <span class="json-bracket">]</span>
                </div>
            `);
        }

        function updateTransform() {
            $('#canvas-viewport').css('transform', `translate(${state.panX}px, ${state.panY}px) scale(${state.zoom})`);
        }

        function toast(msg) {
            const $t = $(`<div class="toast">${msg}</div>`);
            $('#toast-container').append($t);
            setTimeout(() => $t.fadeOut(300, () => $t.remove()), 3000);
        }
    </script>
</body>

</html>